# astrbot_plugin_anti_porn

# astrbot_plugin_anti_porn

## 介绍

`astrbot_plugin_anti_porn` 是一个 Astrbot 插件，专门用于检测和屏蔽群聊中的不当内容（如涉黄信息）。
该插件通过本地关键字检测与 LLM（大语言模型）审查配合使用，有效减少不当内容的传播。

## 功能

- **本地关键字检测**：
    - 根据配置的敏感词列表快速扫描消息内容。
- **LLM 动态审查**：
    - 调用大语言模型对短消息进行智能检测，默认触发概率为 `10%`。
    - 支持自定义规则，提升判定准确性。
- **自动化管理**：
    - 删除违规内容。
    - 对违规用户实施禁言（默认 5 分钟）。
    - 仅在机器人有管理员权限时生效。
- **高度可配置化**：
    - `local_censor_keywords`：本地敏感词列表（以 `;` 分隔）。
    - `llm_censor_probability`：LLM 审查触发概率（默认 `0.1`）。
    - `enable_anti_porn`：启用或禁用反瑟瑟插件。
    - `group_sensor_list`：限制审查的群组列表。
    - `group_ban_time`：禁言时长（单位：分钟，默认 `1` 分钟）。

## 安装与使用

1. **安装插件**
    - 将此插件放置在 Astrbot 的插件目录下，例如 `data/plugins/`。
2. **配置插件**
    - 在 Astrbot 插件配置界面中进行相关配置，确保填写敏感词列表与其他选项。
3. **命令列表**（需要管理员权限）
    - **开启反瑟瑟模式**
      ```
      /anti_porn enable
      ```
    - **关闭反瑟瑟模式**
      ```
      /anti_porn disable
      ```
    - **添加群组到审查名单**
      ```
      /anti_porn add <群号>
      ```
    - **将群组移出审查名单**
      ```
      /anti_porn del <群号>
      ```
    - **查询审查名单**
      ```
      /anti_porn list
      ```

## 工作原理

- 消息审查流程：
    1. 首先检查当前群组是否在配置的审查名单中。
    2. 如果在名单中，依次执行以下步骤：
        - **本地检测：** 使用配置的关键字列表检查消息内容。
        - **LLM 智能检测：** 对短于 50 字的消息按概率触发大模型检测。
    3. 检测到违规消息时，自动删除并对发送者禁言。

- 权限要求：
    - 插件需要机器人拥有管理权限，否则无法执行消息删除与禁言操作。

## 开发与支持

### 扩展方法

- **自定义敏感词规则**：修改配置项 `local_censor_keywords`。
- **调整 LLM 检测概率**：修改 `llm_censor_probability` 配置值。
- **定制禁言时长**：编辑 `group_ban_time`。
  如需要更多功能扩展，开发者可通过插件的事件与权限接口实现进一步自定义。

## 许可证

MIT License

